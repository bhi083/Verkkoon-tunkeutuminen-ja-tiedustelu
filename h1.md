# h1 Sniff

## x) Tiivistelmät

### Karvinen 2025: [Wireshark - Getting Started](https://terokarvinen.com/wireshark-getting-started/)

- Wireshark on paras snifferi ja verkkoanalyysityökalu
- Ladatessa ohjelmaa pitää muistaa antaa riittävät oikeudet ohjelmalle ja käyttäjälle
- Sniffaamalla voi nähdä verkon paketteja
- Paketteja voi tallentaa ja filtteröidä

### Karvinen 2025: [Network Interface Names on Linux](https://terokarvinen.com/network-interface-linux/)

- Network interfacet ovat ns. "kortti"
- Linuxissa käytettyjä network interface lyhenteitä: en = Ethernet, wl= WLAN, lo=loopback adapter
- Network interfacen jälkeen on MAC-osoite tai portti tms. Esim. wlp4s0 = WiFi-kortti.

## a) Linux

Kali linux asennettuna Virtualboxiin, kaikki ok.

## b) Ei voi kalastaa

Netin saa katkaistua graafisesta käyttöliittymästä yläkulmasta. Todistetusti sammutettu:

<img width="474" height="89" alt="Näyttökuva 2025-10-24 123214" src="https://github.com/user-attachments/assets/22a1d692-9463-4c73-8d3a-f585d507f4d9" />

## c) Wireshark

Wireshark on Kalissa valmiiksi ladattuna, joten käynnistetään ohjelma komennolla

    wireshark

Ohjelmasta valitaan "any", jotta nähdään kaikki liikenne.

Sitten pingataan ja katsotaan mitä tallentuu:

<img width="2217" height="762" alt="Näyttökuva 2025-10-25 203650" src="https://github.com/user-attachments/assets/1aee79ec-4f36-42e2-a087-e4abe65a563b" />

Skädäm! Hyvin näkyy.

## d) Oikeesti TCP/IP

<img width="948" height="565" alt="Näyttökuva 2025-10-25 204020" src="https://github.com/user-attachments/assets/73a910db-072e-439d-a1d7-126877f947a8" />

<img width="1296" height="583" alt="Näyttökuva 2025-10-25 204034" src="https://github.com/user-attachments/assets/f27f6880-6533-46c2-b168-d014f57dc68e" />

<img width="1071" height="387" alt="Näyttökuva 2025-10-25 204043" src="https://github.com/user-attachments/assets/49ff50d6-3bde-4ffc-a0e2-912d62170b86" />

Kuvat ovat erään verkkosivun selaamisesta sniffattu HTTP-paketti.

Ylin kuva: Link Layer Access Type- Ethernet (1) on Link Layer, Internet Protocol version 4, eli IPv4, on Internet Layer.

Toinen kuva: Transmission Control Protocol, eli TCP, on Transport Layer.

Alin kuva: HTTP on Application Layer

## e) Mitäs tuli surffattua?

Kohdasta statistics -> endpoints voidaan katsoa, että käytössä on ollut kaksi eri päätettä:

<img width="1006" height="113" alt="Näyttökuva 2025-10-25 205259" src="https://github.com/user-attachments/assets/4c4f3542-c9dd-4fed-a8ea-3ca2404d7a35" />

Kaappausten määrästä ja käytetystä ajasta (molemmat vähäisiä) voidaan päätellä, että kaappaus ei ole kestänyt kauaa eikä se sisällä paljoa paketteja.

## g) Verkkokortti

Verkkokortin valmistajaa voidaan tarkistaa ottamalla paketin MAC-osoitteesta ensimmäiset kolme oktettia (tässä tapauksessa 525400) ja katsomalla esim. IEEE:n OUI Lookup-palvelusta valmistaja.

<img width="1927" height="844" alt="Näyttökuva 2025-10-25 210817" src="https://github.com/user-attachments/assets/40c615c9-ce49-4b48-923c-faac1350fbbb" />

Tällä kertaa vastauksesi tuli kuitenkin tätä. Myös Wireshark ilmoitti, että kyseessä on Locally Administered Address, eli en saanut tällä tavalla verkkokortin valmistajaa selville.

## h) Weppipalvelin

Weppipalvelimen selvittämiseen TLS-paketeista etsimme Client Hello-paketin, Jonka tiedoista löytyy JA3- hash. Kyseisen Hashin pystyy tarkistamaan esimerkiksi [täältä](https://ja3.zone)

<img width="1322" height="689" alt="Näyttökuva 2025-10-25 212111" src="https://github.com/user-attachments/assets/9da70170-d035-4a3f-8499-71c3ac88d1bb" />

Ja näin selvisi, että käytössä oli (todennäköisesti) Ubuntu ja Firefox.

## i) Analyysi

Analysoidaan kyseistä pakettia: 

<img width="1597" height="24" alt="Näyttökuva 2025-10-25 213601" src="https://github.com/user-attachments/assets/660911a3-5e94-437c-968d-c434eb616f0b" />

Paketti on TLS Client Hello, eli edellisen kohdan metodilla voimme selvittää käytössä olevan selaimen:

<img width="1387" height="704" alt="Näyttökuva 2025-10-25 213647" src="https://github.com/user-attachments/assets/8d0bb4ab-4417-49d1-b17e-534aa03feba0" />

Samanlaiselta näyttää kuin edellisessä. Mitenkäs TCP/IP?

<img width="1375" height="266" alt="Näyttökuva 2025-10-25 213524" src="https://github.com/user-attachments/assets/e0d502b7-2c81-43a9-b50d-dd676a633f23" />

Tässä Link Layer on Ethernet (1), Internet Layer on IPv4, Transport Layer on TCP ja Application Layer on TLS.

## Lähteet

Karvinen 2025: [Verkkoon tunkeutuminen ja tiedustelu](https://terokarvinen.com/verkkoon-tunkeutuminen-ja-tiedustelu/#h1-sniff)

Karvinen 2025: [Wireshark - Getting Started](https://terokarvinen.com/wireshark-getting-started/)

Karvinen 2025: [Network Interface Names on Linux](https://terokarvinen.com/network-interface-linux/)

